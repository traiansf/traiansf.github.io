<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Traian Florin È˜erbÄƒnuÈ›Äƒ" />
  <title>Matching Logic in Coq</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Matching Logic in Coq</h1>
  <p class="author">
Traian Florin È˜erbÄƒnuÈ›Äƒ
  </p>
  <p class="institute">
Runtime Verification; UniBuc
  </p>
  <p class="date">Logic Seminar, FMI@UniBuc</p>
</div>
<div id="overview-of-the-talk" class="slide section level2">
<h1>Overview of the talk</h1>
<ul>
<li>(yet another) Introduction to matching logic</li>
<li>Efforts on machine-formalizing matching logic</li>
<li>The matching logic in Lean project</li>
<li>My matching logic in Coq exercise</li>
<li>A shallow embedding of ML in Coq
<ul>
<li>as a semantic theory on sets</li>
</ul></li>
</ul>
</div>
<div id="introduction-to-applicative-matching-logic"
class="title-slide slide section level1">
<h1>Introduction to (applicative) matching logic</h1>

</div>
<div id="what-is-applicative-matching-logic"
class="slide section level2">
<h1>What is (applicative) matching logic</h1>
<h3 id="motivation">Motivation</h3>
<ul>
<li>Introduced to help with deductive verification of program executions
in the <span class="math inline">ğ•‚</span> framework
<ul>
<li>for reasoning about the structure (e.g., memory, call stack, â€¦)</li>
</ul></li>
<li>Gradually refined into a general-purpose logic
<ul>
<li>meant to serve as a mathematical basis for the entire <span
class="math inline">ğ•‚</span> framework</li>
</ul></li>
</ul>
<h3 id="features">Features</h3>
<ul>
<li>FormulÃ¦, named <strong>patterns</strong>, are interpreted as sets
<ul>
<li>allows mixing structure and logical constraints</li>
</ul></li>
<li>Supports fixpoints
<ul>
<li>allows to define and reason about reachability / program
executions</li>
<li>allows defining inductive datatypes</li>
</ul></li>
</ul>
</div>
<div id="matching-logic-syntax" class="slide section level2">
<h1>Matching logic syntax</h1>
<p><span
class="math display"><em>Ï†</em>â€„:â€„:=<em>x</em>â€…âˆ£â€…<em>X</em>â€…âˆ£â€…<em>Ï†</em>â€„â†’â€„<em>Ï†</em>â€²â€…âˆ£â€…âˆƒ<em>x</em>.<em>Ï†</em>â€…âˆ£â€…<em>Î¼</em><em>X</em>.<em>Ï†</em>â€…âˆ£â€…<em>Ïƒ</em>â€…âˆ£â€…<em>Ï†</em>â€…â‹…â€…<em>Ï†</em>â€²âˆ£</span></p>
<dl>
<dt>Structural</dt>
<dd>
element variables (<span class="math inline"><em>x</em></span>);
constant symbols (<span class="math inline"><em>Ïƒ</em></span>);
application (<span class="math inline"><em>Ï†</em>â€…â‹…â€…<em>Ï†</em>â€²</span>)
</dd>
<dt>Logical</dt>
<dd>
set variables (<span class="math inline"><em>X</em></span>); logical
implication (<span class="math inline"><em>Ï†</em>â€„â†’â€„<em>Ï†</em>â€²</span>);
existential cuantification (<span
class="math inline">âˆƒ<em>x</em>.<em>Ï†</em></span>)
</dd>
<dt>Fixpoints</dt>
<dd>
least fixpoint (<span
class="math inline"><em>Î¼</em><em>X</em>.<em>Ï†</em></span>)
</dd>
</dl>
<h3 id="derived-connectives">Derived connectives</h3>
<ul>
<li>false (<span
class="math inline">âŠ¥â€„:=â€„<em>Î¼</em><em>X</em>.<em>X</em></span>);
negation (<span
class="math inline">Â¬<em>Ï•</em>â€„:=â€„<em>Ï•</em>â€„â†’â€„âŠ¥</span>); true (<span
class="math inline">âŠ¤â€„:=â€„Â¬âŠ¥</span>)</li>
<li>disjunction (<span
class="math inline"><em>Ï•</em>â€…âˆ¨â€…<em>Ï•</em>â€²â€„:=â€„Â¬<em>Ï•</em>â€„â†’â€„<em>Ï•</em>â€²</span>);
conjunction (<span
class="math inline"><em>Ï•</em>â€…âˆ§â€…<em>Ï•</em>â€²â€„:=â€„Â¬(Â¬<em>Ï•</em>âˆ¨Â¬<em>Ï•</em>â€²)</span>)</li>
<li>universal cuantification (<span
class="math inline">âˆ€<em>x</em>.<em>Ï•</em>â€„:=â€„Â¬âˆƒ<em>x</em>.Â¬<em>Ï•</em></span>)</li>
</ul>
</div>
<div id="structures-and-valuations" class="slide section level2">
<h1>Structures and Valuations</h1>
<ul>
<li>A <em>structure</em> <span class="math inline">ğ’œ</span> consists of
a carrier set <span class="math inline"><em>A</em></span> and
<ul>
<li>an interpretation <span
class="math inline"><em>Ïƒ</em><sup>ğ’œ</sup>â€„âŠ†â€„<em>A</em></span> for any
constant <span class="math inline"><em>Ïƒ</em></span></li>
<li>an interpretation of the application as a function <span
class="math inline">_â€…â‹†â€…_â€„:â€„<em>A</em>â€…Ã—â€…<em>A</em>â€„â†’â€„2<sup><em>A</em></sup></span></li>
</ul></li>
<li>A <em>valuation</em> (of variables) into structure <span
class="math inline">ğ’œ</span> consists of
<ul>
<li>an interpretation of element variables as elements of <span
class="math inline"><em>A</em></span></li>
<li>an interpretation of set variables as subsets of <span
class="math inline"><em>A</em></span></li>
</ul></li>
<li>A valuation <span class="math inline"><em>e</em></span> into a
structure <span class="math inline">ğ’œ</span> extends to a valuation of
patterns
<ul>
<li><span
class="math inline"><em>e</em><sup>+</sup>(<em>x</em>)â€„=â€„{<em>e</em>(<em>x</em>)}</span>;
<span
class="math inline"><em>e</em><sup>+</sup>(<em>X</em>)â€„=â€„<em>e</em>(<em>X</em>)</span>;
<span
class="math inline"><em>e</em><sup>+</sup>(<em>Ïƒ</em>)â€„=â€„<em>Ïƒ</em><sup>ğ’œ</sup></span></li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(<em>Ï•</em>â†’<em>Ï•</em>â€²)â€„=â€„<em>A</em>â€…\â€…(<em>e</em><sup>+</sup>(<em>Ï•</em>)\<em>e</em><sup>+</sup>(<em>Ï•</em>â€²))</span>;</li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(âˆƒ<em>x</em>.<em>Ï•</em>)â€„=â€„â‹ƒ<sub><em>a</em>â€„âˆˆâ€„<em>A</em></sub>(<em>e</em><sub><em>x</em>â€„â†¦â€„<em>a</em></sub>)<sup>+</sup>(<em>Ï•</em>)</span>
(collecting all witnesses)</li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(<em>Î¼</em><em>X</em>.<em>Ï•</em>)â€„=â€„â‹‚{<em>B</em>â€„âŠ†â€„<em>A</em>â€…âˆ£â€…(<em>e</em><sub><em>X</em>â€„â†¦â€„<em>B</em></sub>)<sup>+</sup>(<em>Ï•</em>)â€„âŠ†â€„<em>B</em>}</span>
(intersection of all pre-fixpoints)</li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(<em>Ï•</em>â‹…<em>Ï•</em>â€²)â€„=â€„<em>e</em><sup>+</sup>(<em>Ï•</em>)â€…â‹†â€…<em>e</em><sup>+</sup>(<em>Ï•</em>â€²)â€„=â€„â‹ƒ<sub><em>a</em>â€„âˆˆâ€„<em>e</em><sup>+</sup>(<em>Ï•</em>),â€†<em>b</em>â€„âˆˆâ€„<em>e</em><sup>+</sup>(<em>Ï•</em>â€²)</sub><em>a</em>â€…â‹†â€…<em>b</em></span>.</li>
</ul></li>
</ul>
</div>
<div id="valuation-of-derived-connectives" class="slide section level2">
<h1>Valuation of derived connectives</h1>
<ul>
<li><span class="math inline"><em>e</em><sup>+</sup>(âŠ¥)â€„=â€„âˆ…</span> and
<span
class="math inline"><em>e</em><sup>+</sup>(âŠ¤)â€„=â€„<em>A</em></span></li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(Â¬<em>Ï•</em>)â€„=â€„(<em>e</em><sup>+</sup>(<em>Ï•</em>))<sup>âˆ</sup></span></li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(<em>Ï•</em>âˆ¨<em>Ï•</em>â€²)â€„=â€„<em>e</em><sup>+</sup>(<em>Ï•</em>)â€…âˆªâ€…<em>e</em><sup>+</sup>(<em>Ï•</em>â€²)</span></li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(<em>Ï•</em>âˆ§<em>Ï•</em>â€²)â€„=â€„<em>e</em><sup>+</sup>(<em>Ï•</em>)â€…âˆ©â€…<em>e</em><sup>+</sup>(<em>Ï•</em>â€²)</span></li>
<li><span
class="math inline"><em>e</em><sup>+</sup>(âˆ€<em>x</em>.<em>Ï•</em>)â€„=â€„â‹‚<sub><em>a</em>â€„âˆˆâ€„<em>A</em></sub>(<em>e</em><sub><em>x</em>â€„â†¦â€„<em>a</em></sub>)<sup>+</sup>(<em>Ï•</em>)</span>
(conjunction over all â€œinstancesâ€)</li>
</ul>
</div>
<div id="satisfaction" class="slide section level2">
<h1>Satisfaction</h1>
<ul>
<li><p>valuation satisfaction: <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em>[<em>e</em>]</span> if <span
class="math inline"><em>e</em><sup>+</sup>(<em>Ï•</em>)â€„=â€„<em>A</em></span></p></li>
<li><p>model satisfaction: <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em></span> if <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em>[<em>e</em>]</span> for every
valuation <span class="math inline"><em>e</em></span></p></li>
<li><p>validity: <span class="math inline">â€„âŠ¨â€„<em>Ï•</em></span> if <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em></span> for every structure <span
class="math inline">ğ’œ</span></p></li>
<li><p>global semantic consequence: <span
class="math inline"><em>Ï•</em>âŠ¨<sub><em>g</em></sub><em>Ï•</em>â€²</span>
if for every <span class="math inline">ğ’œ</span>, <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em></span> implies <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em>â€²</span></p></li>
<li><p>local semantic consequence: <span
class="math inline"><em>Ï•</em>âŠ¨<sub><em>l</em></sub><em>Ï•</em>â€²</span>
if for every <span class="math inline">ğ’œ</span> and <span
class="math inline"><em>e</em></span>, <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em>[<em>e</em>]</span> implies <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em>â€²[<em>e</em>]</span></p></li>
<li><p>strong semantic consequence: <span
class="math inline"><em>Ï•</em>âŠ¨<sub><em>s</em></sub><em>Ï•</em>â€²</span>
if for every <span class="math inline">ğ’œ</span> and <span
class="math inline"><em>e</em></span>, <span
class="math inline"><em>e</em><sup>+</sup>(<em>Ï•</em>)â€„âŠ†â€„<em>e</em><sup>+</sup>(<em>Ï•</em>â€²)</span>.</p></li>
<li><p>globally/locally/strongly logically equivalent: <span
class="math inline"><em>Ï•</em>â‰¡<sub>*</sub><em>Ï•</em>â€²</span> if <span
class="math inline"><em>Ï•</em>âŠ¨<sub>*</sub><em>Ï•</em>â€²</span> and <span
class="math inline"><em>Ï•</em>â€²âŠ¨<sub>*</sub><em>Ï•</em></span>, where
<span class="math inline">*</span> is <span
class="math inline"><em>g</em></span>, <span
class="math inline"><em>l</em></span>, or <span
class="math inline"><em>s</em></span></p></li>
</ul>
</div>
<div id="satisfaction-for-sets-of-patterns"
class="slide section level2">
<h1>Satisfaction for sets of patterns</h1>
<ul>
<li><p>valuation satisfaction for sets of patterns: <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î“</em>[<em>e</em>]</span> if <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Ï•</em>[<em>e</em>]</span> for every <span
class="math inline"><em>Ï•</em>â€„âˆˆâ€„<em>Î“</em></span></p></li>
<li><p>model satisfaction: <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î“</em></span> if <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î“</em>[<em>e</em>]</span> for every
valuation <span class="math inline"><em>e</em></span></p></li>
<li><p>validity: <span class="math inline">â€„âŠ¨â€„<em>Î“</em></span> if <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î“</em></span> for every structure <span
class="math inline">ğ’œ</span></p></li>
<li><p>global semantic consequence: <span
class="math inline"><em>Î“</em>âŠ¨<sub><em>g</em></sub><em>Î”</em></span> if
for every <span class="math inline">ğ’œ</span>, <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î“</em></span> implies <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î”</em></span></p></li>
<li><p>local semantic consequence: <span
class="math inline"><em>Î“</em>âŠ¨<sub><em>l</em></sub><em>Î”</em></span> if
for every <span class="math inline">ğ’œ</span> and <span
class="math inline"><em>e</em></span>, <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î“</em>[<em>e</em>]</span> implies <span
class="math inline">ğ’œâ€„âŠ¨â€„<em>Î”</em>[<em>e</em>]</span></p></li>
<li><p>strong semantic consequence: <span
class="math inline"><em>Î“</em>âŠ¨<sub><em>s</em></sub><em>Î”</em></span> if
for every <span class="math inline">ğ’œ</span> and <span
class="math inline"><em>e</em></span>, <span
class="math inline">â‹‚<sub><em>Î³</em>â€„âˆˆâ€„<em>Î“</em></sub><em>e</em><sup>+</sup>(<em>Î³</em>)â€„âŠ†â€„â‹‚<sub><em>Î´</em>â€„âˆˆâ€„<em>Î”</em></sub><em>e</em><sup>+</sup>(<em>Î´</em>)</span></p></li>
<li><p><span
class="math inline"><em>Î“</em>âŠ¨<sub>*</sub><em>Ï•</em></span> if <span
class="math inline"><em>Î“</em>âŠ¨<sub>*</sub>{<em>Ï•</em>}</span>.</p></li>
<li><p><span class="math inline">âŠ¨<sub><em>s</em></sub></span> is
stronger than <span class="math inline">âŠ¨<sub><em>l</em></sub></span>
which is stronger than <span
class="math inline">âŠ¨<sub><em>g</em></sub></span></p></li>
</ul>
</div>
<div id="free-variables-substitution-positive-and-negative-occurences"
class="slide section level2">
<h1>Free Variables, Substitution, Positive and Negative Occurences</h1>
<ul>
<li><em>Free variables</em> (<span
class="math inline"><em>F</em><em>V</em>(<em>Ï•</em>)</span>) and
<em>substitution</em> (<span
class="math inline"><em>S</em><em>u</em><em>b</em><em>f</em><sub><em>Ï‡</em></sub><sup><em>x</em></sup><em>Ï•</em></span>)
are defined as usual, noting that <span class="math inline">âˆƒ</span> and
<span class="math inline"><em>Î¼</em></span> bind their respective
variables</li>
<li>a free occurence of <span class="math inline"><em>X</em></span> in
<span class="math inline"><em>Ï•</em></span> is
<em>positive</em>/<em>negative</em> if it occurs in the left operand of
an even/odd number of implication operators.</li>
<li>An <em>applicative context</em> <strong><span
class="math inline"><em>C</em></span></strong> is a pattern containing a
unique occurence of a special set-variable <span
class="math inline">â–¡</span> with the property that on the path from
<span class="math inline">â–¡</span> to the top of the pattern there are
only application operators.
<ul>
<li><span class="math inline"><em>C</em>[<em>Ï•</em>]</span> denotes the
substitution of <span class="math inline">â–¡</span> by <span
class="math inline"><em>Ï•</em></span> in <span
class="math inline"><em>C</em></span>.</li>
</ul></li>
</ul>
</div>
<div id="matching-logic-proof-system-axioms"
class="slide section level2">
<h1>Matching logic proof system (axioms)</h1>
<p><img src="Images/ML-axioms.png" /></p>
</div>
<div id="matching-logic-proof-system-deduction-rules"
class="slide section level2">
<h1>Matching logic proof system (deduction rules)</h1>
<p><img src="Images/ML-rules.png" /></p>
</div>
<div id="soundness" class="slide section level2">
<h1>Soundness</h1>
<dl>
<dt>Global Soundness</dt>
<dd>
Let <span class="math inline">âŠ¢</span> be the deduction induced by the
proof system above. Then <span
class="math inline"><em>Î“</em>â€„âŠ¢â€„<em>Ï•</em></span> implies <span
class="math inline"><em>Î“</em>âŠ¨<sub><em>g</em></sub><em>Ï•</em></span>.
</dd>
<dt>Local Soundness</dt>
<dd>
Let <span class="math inline">âŠ¢<sub><em>l</em></sub></span> be the
deduction induced by the proof system above from which (<span
class="math inline">âˆƒ</span>-QUANTIFIER RULE) and (SET VARIABLE
SUBSTITUTION) were removed. Then <span
class="math inline"><em>Î“</em>âŠ¢<sub><em>l</em></sub><em>Ï•</em></span>
implies <span
class="math inline"><em>Î“</em>âŠ¨<sub><em>l</em></sub><em>Ï•</em></span>.
</dd>
<dt>Strong Soundness</dt>
<dd>
Let <span class="math inline">âŠ¢<sub><em>s</em></sub></span> be the
deduction induced by the proof system for <span
class="math inline">âŠ¢<sub><em>l</em></sub></span> from which (FRAMING)
and (KNASTER-TARSKI) were <em>additionally</em> removed. Then <span
class="math inline"><em>Î“</em>âŠ¢<sub><em>s</em></sub><em>Ï•</em></span>
implies <span
class="math inline"><em>Î“</em>âŠ¨<sub><em>s</em></sub><em>Ï•</em></span>.
</dd>
</dl>
</div>
<div id="computer-based-formalizations-of-matching-logic"
class="slide section level2">
<h1>Computer-based formalizations of matching logic</h1>
<ul>
<li>University of Illinois
<ul>
<li>just syntax and deduction (in Metamath / Maude)</li>
<li>interactive theorem prover for ML + propositional tautology
verifier</li>
</ul></li>
<li>EÃ¶tvÃ¶s LorÃ¡nd University, Hungary
<ul>
<li>syntax, semantics, deduction, soundness (using Coq)</li>
<li>an interactive theorem prover for ML (a proof mode, also in
Coq)</li>
</ul></li>
<li>Institute of Logic and Data Science, Bucharest
<ul>
<li>syntax, semantics, deduction, soundness (using Lean)</li>
<li>export ML proofs to Metamath</li>
</ul></li>
</ul>
</div>
<div id="matching-logic-in-lean-project" class="slide section level2">
<h1>Matching Logic in Lean project</h1>
<ul>
<li><p>Institute of Logic and Data Science, Bucharest</p></li>
<li><p>Phase I (completed)</p>
<ul>
<li>a detailed mathematical exposition of (applicative) matching
logic</li>
<li>syntax, semantics, deduction, soundness formalized using Lean</li>
<li>export ML proofs from Lean to Metamath</li>
</ul></li>
<li><p>Phase II (not yet started?)</p>
<ul>
<li>build first-order matching logit on top of applicative matching
logic</li>
<li>import a K programming language specification</li>
<li>certify a program execution</li>
</ul></li>
</ul>
</div>
<div id="my-matching-logic-in-coq-exercise"
class="slide section level2">
<h1>My matching logic in Coq exercise</h1>
<p><a
href="http://github.com/traiansf/aml-in-coq">http://github.com/traiansf/aml-in-coq</a></p>
<ul>
<li>Follow the mathematical exposition of (applicative) matching logic
as close as possible</li>
<li>went through it page by page and added definitions and lemmas to Coq
<ul>
<li>even specified and proved unique readability</li>
<li>even specified and proved the set theory appendix <a
href="https://github.com/traiansf/sets-in-coq">https://github.com/traiansf/sets-in-coq</a></li>
</ul></li>
</ul>
</div>
<div id="credits-and-acknowledgements" class="slide section level2">
<h1>Credits and Acknowledgements</h1>
<ul>
<li>Grigore RoÈ™u
<ul>
<li>for matching logic itself</li>
</ul></li>
<li>LaurenÈ›iu LeuÈ™tean
<ul>
<li>for the lecture notes on matching logic used here</li>
</ul></li>
<li>Ioana LeuÈ™tean &amp; Natalia Ozunu
<ul>
<li>for making me see matching logic as a modal logic</li>
</ul></li>
<li>My team at Runtime Verification, Inc.
<ul>
<li>for providing suggestions on Coq technical issues</li>
</ul></li>
</ul>
</div>

<div id="thank-you" class="title-slide slide section level1">
<h1>Thank you</h1>

</div>
</body>
</html>
